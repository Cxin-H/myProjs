var initDate = new Date();
var B_href = window.location.href;
function getCookie(c_name) {
	if(document.cookie.length > 0) {
		var c_start = document.cookie.indexOf(c_name + "=");
		if(c_start != -1) {
			c_start = c_start + c_name.length + 1;
			var c_end = document.cookie.indexOf(";", c_start);
			if(c_end == -1) {
				c_end = document.cookie.length;
			}
			return unescape(document.cookie.substring(c_start, c_end))
		}
	}
	return "";
}
//window.location.href
var backUrl = encodeURI(window.location.href);

(function(global) {
	"use strict";
	var _JingsocialBase64 = global.JingsocialBase64;
	var version = "2.1.9";
	var buffer;
	if(typeof module !== "undefined" && module.exports) {
		try {
			buffer = require("buffer").Buffer
		} catch(err) {}
	}
	var b64chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
	var b64tab = function(bin) {
		var t = {};
		for(var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;
		return t
	}(b64chars);
	var fromCharCode = String.fromCharCode;
	var cb_utob = function(c) {
		if(c.length < 2) {
			var cc = c.charCodeAt(0);
			return cc < 128 ? c : cc < 2048 ? fromCharCode(192 | cc >>> 6) + fromCharCode(128 | cc & 63) : fromCharCode(224 | cc >>> 12 & 15) + fromCharCode(128 | cc >>> 6 & 63) + fromCharCode(128 | cc & 63)
		} else {
			var cc = 65536 + (c.charCodeAt(0) - 55296) * 1024 + (c.charCodeAt(1) - 56320);
			return fromCharCode(240 | cc >>> 18 & 7) + fromCharCode(128 | cc >>> 12 & 63) + fromCharCode(128 | cc >>> 6 & 63) + fromCharCode(128 | cc & 63)
		}
	};
	var re_utob = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g;
	var utob = function(u) {
		return u.replace(re_utob, cb_utob)
	};
	var cb_encode = function(ccc) {
		var padlen = [0, 2, 1][ccc.length % 3],
			ord = ccc.charCodeAt(0) << 16 | (ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8 | (ccc.length > 2 ? ccc.charCodeAt(2) : 0),
			chars = [b64chars.charAt(ord >>> 18), b64chars.charAt(ord >>> 12 & 63), padlen >= 2 ? "=" : b64chars.charAt(ord >>> 6 & 63), padlen >= 1 ? "=" : b64chars.charAt(ord & 63)];
		return chars.join("")
	};
	var btoa = global.btoa ? function(b) {
		return global.btoa(b)
	} : function(b) {
		return b.replace(/[\s\S]{1,3}/g, cb_encode)
	};
	var _encode = buffer ? function(u) {
		return(u.constructor === buffer.constructor ? u : new buffer(u)).toString("base64")
	} : function(u) {
		return btoa(utob(u))
	};
	var encode = function(u, urisafe) {
		return !urisafe ? _encode(String(u)) : _encode(String(u)).replace(/[+\/]/g, function(m0) {
			return m0 == "+" ? "-" : "_"
		}).replace(/=/g, "")
	};
	var encodeURI = function(u) {
		return encode(u, true)
	};
	var re_btou = new RegExp(["[À-ß][-¿]", "[à-ï][-¿]{2}", "[ð-÷][-¿]{3}"].join("|"), "g");
	var cb_btou = function(cccc) {
		switch(cccc.length) {
			case 4:
				var cp = (7 & cccc.charCodeAt(0)) << 18 | (63 & cccc.charCodeAt(1)) << 12 | (63 & cccc.charCodeAt(2)) << 6 | 63 & cccc.charCodeAt(3),
					offset = cp - 65536;
				return fromCharCode((offset >>> 10) + 55296) + fromCharCode((offset & 1023) + 56320);
			case 3:
				return fromCharCode((15 & cccc.charCodeAt(0)) << 12 | (63 & cccc.charCodeAt(1)) << 6 | 63 & cccc.charCodeAt(2));
			default:
				return fromCharCode((31 & cccc.charCodeAt(0)) << 6 | 63 & cccc.charCodeAt(1))
		}
	};
	var btou = function(b) {
		return b.replace(re_btou, cb_btou)
	};
	var cb_decode = function(cccc) {
		var len = cccc.length,
			padlen = len % 4,
			n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0) | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0) | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0) | (len > 3 ? b64tab[cccc.charAt(3)] : 0),
			chars = [fromCharCode(n >>> 16), fromCharCode(n >>> 8 & 255), fromCharCode(n & 255)];
		chars.length -= [0, 0, 2, 1][padlen];
		return chars.join("")
	};
	var atob = global.atob ? function(a) {
		return global.atob(a)
	} : function(a) {
		return a.replace(/[\s\S]{1,4}/g, cb_decode)
	};
	var _decode = buffer ? function(a) {
		return(a.constructor === buffer.constructor ? a : new buffer(a, "base64")).toString()
	} : function(a) {
		return btou(atob(a))
	};
	var decode = function(a) {
		return _decode(String(a).replace(/[-_]/g, function(m0) {
			return m0 == "-" ? "+" : "/"
		}).replace(/[^A-Za-z0-9\+\/]/g, ""))
	};
	var noConflict = function() {
		var JingsocialBase64 = global.JingsocialBase64;
		global.JingsocialBase64 = _JingsocialBase64;
		return JingsocialBase64
	};
	global.JingsocialBase64 = {
		VERSION: version,
		atob: atob,
		btoa: btoa,
		fromJingsocialBase64: decode,
		toJingsocialBase64: encode,
		utob: utob,
		encode: encode,
		encodeURI: encodeURI,
		btou: btou,
		decode: decode,
		noConflict: noConflict
	};
	if(typeof Object.defineProperty === "function") {
		var noEnum = function(v) {
			return {
				value: v,
				enumerable: false,
				writable: true,
				configurable: true
			}
		};
		global.JingsocialBase64.extendString = function() {
			Object.defineProperty(String.prototype, "fromJingsocialBase64", noEnum(function() {
				return decode(this)
			}));
			Object.defineProperty(String.prototype, "toJingsocialBase64", noEnum(function(urisafe) {
				return encode(this, urisafe)
			}));
			Object.defineProperty(String.prototype, "toJingsocialBase64URI", noEnum(function() {
				return encode(this, true)
			}))
		}
	}
	if(global["Meteor"]) {
		JingsocialBase64 = global.JingsocialBase64
	}
})(this);
"use strict";
! function(a) {
	var b = {},
		c = ["11(4|5)Browser", "2345(Explorer|chrome)", "Conkeror", "Alienforce", "Amaya", "Arora", "Beamrise", "Beonex", "Blazer", "bidubrowser", "Blackbird", "Bolt", "Browzar", "Bunjalloo", "Camino", "Chromium", "Classilla", "Coast", "Columbus", "Cruz", "Cyberdog", "Demeter", "Dooble", "dillo", "Doris", "Edbrowse", "E?links", "Epiphany", "Escape|Espial", "Fennec", "Firebird", "Flock", "Fluid", "Galeon", "Hv3", "Iris", "lolifox", "Iceape", "Hana", "Kapiko", "Kazehakase", "Kinza", "Konqueror", "Kylo", "Lunascape", "Lynx", "Madfox", "Maxthon", "Midori", "Minefield", "Minimo", "Mosaic", "Netscape", "Obigo", "Orca", "Oregano", "Otter", "Perk", "Phoenix", "Podkicker", "Ryouko", "Sleipnir", "Shiira", "Skyfire", "Stainless", "Sundance", "Sunrise", "Surf", "Swiftfox", "Swiftweasel", "Thunderbird", "Tjusig", "UC? ?Browser|UCWEB", "polarity", "polaris", "pogo", "prism", "superbird", "songbird", "Usejump", "Vivaldi", "Wyzo", "WhatsApp", "Weibo"],
		d = {
			"360se": {
				title: "360 Explorer"
			},
			"360ee": {
				title: "360 Chrome",
				image: "360se"
			},
			"360 aphone browser": {
				title: "360 Aphone Browser",
				image: "360se"
			},
			abolimba: {
				title: "Abolimba"
			},
			"acoo browser": {
				title: "{%Acoo Browser%}",
				image: "acoobrowser"
			},
			"amiga-aweb": {
				title: "Amiga {%AWeb%}",
				image: "amiga-aweb"
			},
			antfresco: {
				title: "ANT {%Fresco%}"
			},
			mrchrome: {
				title: "Amigo",
				image: "amigo"
			},
			myibrow: {
				title: "{%myibrow%}",
				image: "my-internet-browser"
			},
			"america online browser": {
				title: "{%America Online Browser%}",
				image: "aol"
			},
			amigavoyager: {
				title: "Amiga {%Voyager%}"
			},
			aol: {
				upper: [0, 1, 2]
			},
			atomicbrowser: {
				upper: [0, 6],
				image: "atomicwebbrowser"
			},
			barcapro: {
				title: "{%BarcaPro%}",
				image: "barca"
			},
			baidubrowser: {
				image: "bidubrowser"
			},
			baiduhd: {
				title: "{%BaiduHD%}",
				image: "bidubrowser"
			},
			blackhawk: {
				upper: [0, 5]
			},
			bonecho: {
				title: "{%BonEcho%}",
				image: "firefoxdevpre"
			},
			browsex: {
				upper: [0, 6]
			},
			"cayman browser": {
				title: "{%Cayman Browser%}",
				image: "caymanbrowser"
			},
			charon: {
				image: "null"
			},
			cheshire: {
				image: "aol"
			},
			chimera: {
				image: "null"
			},
			chromeframe: {
				image: "chrome"
			},
			chromeplus: {
				title: "{%ChromePlus%}"
			},
			iron: {
				title: "SRWare {%Iron%}",
				image: "srwareiron"
			},
			cometbird: {
				upper: [0, 5]
			},
			comodo_dragon: {
				title: "Comodo {%Dragon%}",
				image: "comodo-dragon"
			},
			coolnovo: {
				upper: [0, 4]
			},
			corom: {
				upper: [0, 2]
			},
			"crazy browser": {
				upper: [0, 6],
				image: "crazybrowser"
			},
			crmo: {
				upper: [0, 2],
				image: "chrome"
			},
			dplus: {
				upper: [0, 1],
				image: "dillo"
			},
			"deepnet explorer": {
				upper: [0, 8],
				image: "deepnetexplorer"
			},
			deskbrowse: {
				upper: [0, 4]
			},
			docomo: {
				upper: [0, 2, 4],
				image: "null"
			},
			doczilla: {
				upper: [0, 3]
			},
			dolfin: {
				image: "samsung"
			},
			dorothy: {
				image: "dorothybrowser"
			},
			"element browser": {
				upper: [0, 8],
				image: "elementbrowser"
			},
			"enigma browser": {
				upper: [0, 7],
				image: "enigmabrowser"
			},
			enigmafox: {
				upper: [0, 6],
				image: "null"
			},
			epic: {
				image: "epicbrowser"
			},
			escape: {
				image: "espialtvbrowser"
			},
			espial: {
				image: "espialtvbrowser"
			},
			"fireweb navigator": {
				upper: [0, 8],
				image: "firewebnavigator"
			},
			fbav: {
				title: "{%FBAV%}",
				image: "facebook"
			},
			globalmojo: {
				upper: [0, 6]
			},
			gobrowser: {
				upper: [0, 1, 2]
			},
			"google wireless transcoder": {
				title: "Google Wireless Transcoder",
				image: "google"
			},
			"google earth": {
				upper: [0, 7],
				image: "google"
			},
			"google.android.apps": {
				title: "Google App",
				image: "google"
			},
			googleplus: {
				title: "Google+",
				image: "google"
			},
			youtube: {
				title: "{%Youtube%}",
				image: "google"
			},
			gosurf: {
				upper: [0, 2]
			},
			granparadiso: {
				upper: [0, 4],
				image: "firefoxdevpre"
			},
			greenbrowser: {
				upper: [0, 5]
			},
			gsa: {
				upper: [0, 1, 2],
				image: "google"
			},
			hotjava: {
				upper: [0, 3]
			},
			"hydra browser": {
				title: "Hydra Browser",
				image: "hydrabrowser"
			},
			"ibm webexplorer": {
				title: "IBM {%WebExplorer%}",
				image: "ibmwebexplorer"
			},
			juzibrowser: {
				upper: [0, 4]
			},
			miuibrowser: {
				upper: [0, 4]
			},
			mxnitro: {
				upper: [0, 2]
			},
			ibrowse: {
				upper: [0, 1]
			},
			icab: {
				upper: [1]
			},
			icebrowser: {
				upper: [0, 3]
			},
			icecat: {
				title: "GNU {%IceCat%}"
			},
			icedragon: {
				upper: [0, 3]
			},
			iceweasel: {
				upper: [0, 3]
			},
			"inet browser": {
				upper: [1, 5],
				image: "null"
			},
			irider: {
				upper: [1]
			},
			internetsurfboard: {
				upper: [0, 8]
			},
			itunes: {
				upper: [1]
			},
			jasmine: {
				image: "samsung"
			},
			"k-meleon": {
				upper: [0, 2],
				image: "kmeleon"
			},
			"k-ninja": {
				upper: [0, 2],
				image: "kninja"
			},
			strata: {
				title: "Kirix {%Strata%}",
				image: "kirix-strata"
			},
			sailfishbrowser: {
				title: "{%SailfishBrowser%}",
				upper: [0, 8]
			},
			kkman: {
				upper: [0, 1]
			},
			kmail: {
				upper: [0, 1]
			},
			kmlite: {
				upper: [0, 1, 2],
				image: "kmeleon"
			},
			lbrowser: {
				upper: [0, 1]
			},
			links: {
				image: "null"
			},
			lbbrowser: {
				title: "Liebao Browser"
			},
			liebaofast: {
				image: "lbbrowser"
			},
			leechcraft: {
				title: "LeechCraft",
				image: "null"
			},
			lobo: {
				upper: [0]
			},
			lorentz: {
				upper: [0],
				image: "firefoxdevpre"
			},
			"maemo browser": {
				upper: [0, 6],
				image: "maemo"
			},
			" mib/": {
				title: "{%MIB%}",
				image: "mib"
			},
			micromessenger: {
				upper: [0, 5],
				image: "wechat"
			},
			"microsoft office": {
				title: "{%Microsoft Office%}",
				upper: [0, 10],
				image: "office"
			},
			minibrowser: {
				upper: [0, 5]
			},
			mozilladeveloperpreview: {
				title: "{%MozillaDeveloperPreview%}",
				image: "firefoxdevpre"
			},
			mqqbrowser: {
				upper: [0, 1, 2, 3],
				image: "qqbrowser"
			},
			"multi-browser": {
				upper: [0, 6],
				image: "multi-browserxp"
			},
			multizilla: {
				upper: [0, 5],
				image: "mozilla"
			},
			myie2: {
				upper: [0, 2, 3]
			},
			namoroka: {
				image: "firefoxdevpre"
			},
			navigator: {
				title: "Netscape {%Navigator%}",
				image: "netscape"
			},
			netbox: {
				upper: [0, 3]
			},
			netcaptor: {
				upper: [0, 3]
			},
			netfront: {
				upper: [0, 3]
			},
			netnewswire: {
				upper: [0, 3, 7]
			},
			netpositive: {
				upper: [0, 3]
			},
			netsurf: {
				upper: [0, 3]
			},
			"nf-browser": {
				upper: [0, 1, 2, 4],
				image: "netfront"
			},
			"nichrome/self": {
				title: "{%Nichrome/self%}",
				image: "nichromeself"
			},
			nokiabrowser: {
				title: "Nokia {%Browser%}",
				image: "nokia"
			},
			"novarra-vision": {
				title: "Novarra {%Vision%}",
				image: "novarra"
			},
			offbyone: {
				title: "Off By One"
			},
			omniweb: {
				upper: [0, 4]
			},
			onebrowser: {
				upper: [0, 3]
			},
			"origyn web browser": {
				title: "Oregano Web Browser",
				image: "owb"
			},
			"osb-browser": {
				image: "null"
			},
			" pre/": {
				title: "Palm {%Pre%}",
				image: "palmpre"
			},
			palemoon: {
				title: "Pale {%Moon%}"
			},
			"patriott::browser": {
				title: "Patriott {%Browser%}",
				image: "patriott"
			},
			phaseout: {
				title: "Phaseout"
			},
			"playstation 4": {
				title: "PS4 Web Browser",
				image: "webkit"
			},
			"podkicker pro": {
				upper: [0, 8],
				image: "podkicker"
			},
			qqbrowser: {
				upper: [0, 1, 2]
			},
			"qtweb internet browser": {
				title: "{%QtWeb Internet Browser%}",
				image: "qtwebinternetbrowser"
			},
			qtcarbrowser: {
				image: "tesla"
			},
			qupzilla: {
				upper: [0, 3]
			},
			rekonq: {
				title: "rekonq"
			},
			retawq: {
				image: "terminal"
			},
			rockmelt: {
				upper: [0, 4]
			},
			saayaa: {
				title: "SaaYaa Explorer"
			},
			seamonkey: {
				upper: [0, 3]
			},
			"semc-browser": {
				upper: [0, 1, 2, 3, 5],
				image: "semcbrowser"
			},
			"semc-java": {
				upper: [0, 1, 2, 3],
				image: "semcbrowser"
			},
			shiretoko: {
				upper: [0],
				image: "firefoxdevpre"
			},
			sitekiosk: {
				upper: [0, 4]
			},
			skipstone: {
				upper: [0, 4]
			},
			silk: {
				title: "Amazon {%Silk%}"
			},
			slimboat: {
				upper: [0, 4]
			},
			slimbrowser: {
				upper: [0, 4]
			},
			smarttv: {
				upper: [0, 5, 6],
				image: "maplebrowser"
			},
			substream: {
				upper: [0, 3]
			},
			sulfur: {
				title: "Flock {%Sulfur%}",
				image: "flock"
			},
			sylera: {
				upper: [0],
				image: "null"
			},
			taobrowser: {
				upper: [0, 3]
			},
			tear: {
				title: "Tear"
			},
			teashark: {
				upper: [0, 3]
			},
			teleca: {
				image: "obigo"
			},
			tencenttraveler: {
				title: "Tencent {%Traveler%}"
			},
			tenfourfox: {
				upper: [0, 3, 7]
			},
			tizenbrowser: {
				title: "{%TizenBrowser%}",
				image: "tizen"
			},
			"tizen browser": {
				title: "{%Tizen Browser%}",
				image: "tizen"
			},
			theworld: {
				title: "TheWorld Browser"
			},
			ubrowser: {
				upper: [0, 1],
				image: "ucbrowser"
			},
			ucbrowser: {
				upper: [0, 1, 2, 3]
			},
			"uc browser": {
				upper: [0, 1, 2, 4],
				image: "ucbrowser"
			},
			ucweb: {
				upper: [0, 1, 2, 3, 4],
				image: "ucbrowser"
			},
			ultrabrowser: {
				upper: [0, 5]
			},
			"up.browser": {
				upper: [0, 3],
				image: "openwave"
			},
			"up.link": {
				upper: [0, 3],
				image: "openwave"
			},
			uzardweb: {
				title: "{%uZardWeb%}"
			},
			uzard: {
				upper: [1],
				image: "uzardweb"
			},
			uzbl: {
				title: "uzbl"
			},
			vimprobable: {
				upper: [0],
				image: "null"
			},
			vonkeror: {
				upper: [0],
				image: "null"
			},
			w3m: {
				upper: [0, 2]
			},
			wget: {
				image: "null"
			},
			curl: {
				image: "null"
			},
			iemobile: {
				upper: [0, 1, 2],
				image: "msie-mobile"
			},
			waterfox: {
				upper: [0, 5]
			},
			webianshell: {
				title: "Webian {%Shell%}"
			},
			webrender: {
				upper: [0]
			},
			weltweitimnetzbrowser: {
				title: "Weltweitimnetz {%Browser%}",
				image: "weltweitimnetzbrowser"
			},
			"whitehat aviator": {
				upper: [0, 5, 9],
				image: "aviator"
			},
			wkiosk: {
				title: "wKiosk"
			},
			worldwideweb: {
				upper: [0, 5, 9]
			},
			"x-smiles": {
				upper: [0, 2]
			},
			xiino: {
				image: "null"
			},
			yabrowser: {
				upper: [0, 2],
				image: "yandex"
			},
			zbrowser: {
				upper: [1]
			},
			zipzap: {
				upper: [0, 3]
			},
			abrowse: {
				title: "{%ABrowse Browser%}"
			},
			none: {
				title: "Unknown",
				image: "unknown"
			}
		},
		e = new RegExp(c.concat(Object.keys(d)).join("|"), "i"),
		f = {
			msie: {
				callback: function(a, b) {
					"7.0" === b.version && /Trident\/4.0/i.test(b.ua) ? (b.name = " 8.0 (Compatibility Mode)", b.version = "") : b.name = ""
				}
			},
			"microsoft office": {
				callback: function(a, b) {
					b.version = ""
				}
			},
			"nf-browser": {
				name: "NetFront"
			},
			"semc-browser": {
				name: "SEMC Browser"
			},
			ucweb: {
				name: "UC Browser"
			},
			ubrowser: {
				name: "UC Browser"
			},
			ucbrowser: {
				name: "UC Browser"
			},
			"uc browser": {
				name: "UC Browser"
			},
			bidubrowser: {
				name: "Baidu Browser"
			},
			baidubrowser: {
				name: "Baidu Browser"
			},
			baiduhd: {
				name: "Baidu Browser"
			},
			"up.browser": {
				name: "Openwave Mobile Browser"
			},
			"up.link": {
				name: "Openwave Mobile Browser"
			},
			chromeframe: {
				name: "Google Chrome Frame"
			},
			mozilladeveloperpreview: {
				name: "Mozilla Developer Preview"
			},
			"opera mobi": {
				name: "Opera Mobile"
			},
			"osb-browser": {
				name: "Gtk+ WebCore"
			},
			"tablet browser": {
				name: "MicroB"
			},
			crmo: {
				name: "Chrome Mobile"
			},
			smarttv: {
				name: "Maple Browser"
			},
			miuibrowser: {
				name: "MIUI Browser"
			},
			sailfishbrowser: {
				name: "Sailfish Browser"
			},
			fbav: {
				name: "Facebook"
			},
			atomicbrowser: {
				name: "Atomic Web Browser"
			},
			dplus: {
				name: "D+"
			},
			micromessenger: {
				name: "WeChat"
			},
			"nichrome/self": {
				name: "NiChrome"
			},
			tizenbrowser: {
				name: "Tizen Browser"
			},
			gsa: {
				name: "Google Search App"
			},
			"opera labs": {
				callback: function(a, b) {
					a = b.ua.match(/Edition Labs([ ._0-9a-zA-Z]+);/i), null !== a ? b.version = a[1] : b.version = ""
				}
			},
			qtcarbrowser: {
				name: "Tesla Car Browser",
				version: ""
			},
			iceweasel: {
				callback: function(a, b) {
					"Firefox" === b.version && (b.version = "")
				}
			},
			yabrowser: {
				callback: function(a, b) {
					b.name = "Yandex.Browser"
				}
			}
		},
		g = function(a, b) {
			a.image = b.image, a.full = b.title.replace(/\{%(.+)%\}/, function(b, c) {
				return h(a, c)
			})
		},
		h = function(a, b) {
			var c = b.toLowerCase(),
				d = c;
			a.name = b, "opera" !== c && "opera next" !== c && "opera developer" !== c || !/OPR/i.test(a.ua) ? ("opera" === c || "opera next" === c || "opera labs" === c) && /Version/i.test(a.ua) || "opera mobi" === c && /Version/i.test(a.ua) || "safari" === c && /Version/i.test(a.ua) || "pre" === c && /Version/i.test(a.ua) || "android webkit" === c ? d = "Version" : "links" === c ? d = "Links (" : "smarttv" === c ? d = "WebBrowser" : "ucweb" === c && /UCBrowser/i.test(a.ua) ? d = "UCBrowser" : "tenfourfox" === c || "classilla" === c || "msie" === c && / rv:([.0-9a-zA-Z]+)/i.test(a.ua) ? d = " rv" : "nichrome/self" === c && (d = "self") : d = "OPR", d = d.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]", "g"), "\\$&");
			var e = new RegExp(d + "[ |/|:]?([.0-9a-zA-Z]+)", "i"),
				g = a.ua.match(e);
			if(null !== g ? a.version = g[1] : a.version = "", "build" === a.version.toLowerCase() && (a.version = ""), c in f)
				if("callback" in f[c]) f[c].callback(g, a);
				else
					for(var h in f[c]) a[h] = f[c][h];
			return a.name + ("" !== a.version ? " " + a.version : "")
		};
	b.analyze = function(a) {
		var b = {
				ua: a,
				name: "",
				version: "",
				full: "",
				image: "",
				dir: "browser"
			},
			c = a.match(e),
			f = null;
		if(null !== c) {
			var i = c[0].toLowerCase(),
				j = null;
			if(f = {}, d[i] && Object.keys(d[i]).forEach(function(a) {
					"upper" !== a ? f[a] = d[i][a] : j = d[i].upper
				}), !("title" in f))
				if(null !== j) {
					var k = i;
					j.forEach(function(a) {
						k = k.substr(0, a) + k.substr(a, 1).toUpperCase() + k.substr(a + 1, k.length)
					}), f.title = "{%" + k + "%}"
				} else f.title = "{%" + i.toLowerCase().replace(/[a-z]/, function(a) {
						return a.toUpperCase()
					}) + "%}";
			"image" in f || (f.image = i), g(b, f)
		} else if(/QQ(?!Download|Pinyin)/.test(b.ua)) b.full = h(b, "QQ"), b.image = "qq";
		else if(/Galaxy/i.test(b.ua) && !/Chrome/i.test(b.ua)) b.full = h(b, "Galaxy"), b.image = "galaxy";
		else if(/Opera Mini/i.test(b.ua)) b.full = h(b, "Opera Mini"), b.image = "opera-2";
		else if(/Opera Mobi/i.test(b.ua)) b.full = h(b, "Opera Mobi"), b.image = "opera-2";
		else if(/Opera/i.test(b.ua)) b.full = h(b, "Opera"), b.image = "opera-1", /Version/i.test(b.ua) && (b.image = "opera-2");
		else if(/OPR/i.test(b.ua)) /(Edition Next)/i.test(b.ua) ? (b.full = h(b, "Opera Next"), b.image = "opera-next") : /(Edition Developer)/i.test(b.ua) ? (b.full = h(b, "Opera Developer"), b.image = "opera-developer") : (b.full = h(b, "Opera"), b.image = "opera-1");
		else if(/SE /i.test(b.ua) && /MetaSr/i.test(b.ua)) b.name = b.full = "Sogou Explorer", b.image = "sogou";
		else if(/Ubuntu; Mobile/i.test(b.ua) || /Ubuntu; Tablet/i.test(b.ua) && /WebKit/i.test(b.ua)) b.name = b.full = "Ubuntu Web Browser", b.image = "ubuntuwebbrowser";
		else if(/Avant Browser/i.test(b.ua)) b.full = "Avant " + h(b, "Browser"), b.image = "avantbrowser";
		else if(/AppleWebkit/i.test(b.ua) && /Android/i.test(b.ua) && !/Chrome/i.test(b.ua)) b.full = h(b, "Android Webkit"), b.image = "android-webkit";
		else if(/Windows.+Chrome.+Edge/i.test(b.ua)) b.full = h(b, "Edge"), b.image = "edge";
		else if(/Chrome|crios/i.test(b.ua)) /crios/i.test(b.ua) ? (b.full = "Google " + h(b, "CriOS"), b.image = "chrome") : (b.full = "Google " + h(b, "Chrome"), b.image = "chrome");
		else if(/Nokia/i.test(b.ua) && !/Trident/i.test(b.ua)) b.full = "Nokia Web Browser", b.image = "maemo";
		else if(/Safari/i.test(b.ua)) b.name = "Safari", /Version/i.test(b.ua) ? b.full = h(b, "Safari") : b.full = b.name, /Mobile ?Safari/i.test(b.ua) && (b.name = "Mobile " + b.name, b.full = "Mobile " + b.full), b.image = "safari";
		else if(/Firefox/i.test(b.ua)) b.full = h(b, "Firefox"), b.image = "firefox";
		else if(/MSIE/i.test(b.ua) || /Trident/i.test(b.ua)) {
			if(b.full = "Internet Explorer" + h(b, "MSIE"), b.image = "msie", f = b.ua.match(/(MSIE[ |\/]?| rv:)([.0-9a-zA-Z]+)/i), null !== f) {
				var l = parseInt(f[2]);
				l >= 11 ? b.image = "msie11" : l >= 10 ? b.image = "msie10" : l >= 9 ? b.image = "msie9" : l >= 7 ? b.image = "msie7" : l >= 6 ? b.image = "msie6" : l >= 4 ? b.image = "msie4" : l >= 3 ? b.image = "msie3" : l >= 2 && (b.image = "msie2")
			}
		} else /Mozilla/i.test(b.ua) ? (b.full = "Mozilla Compatible", b.image = "mozilla") : (b.name = "Unknown", b.image = "null", b.full = b.name);
		return b
	}, "undefined" != typeof module && module.exports ? module.exports = b : "undefined" != typeof define && define.amd ? define([], function() {
		return b
	}) : "undefined" != typeof define && define.cmd ? define([], function(a, c, d) {
		d.exports = b
	}) : (a.USERAGENT_BROWSER = function() {}, a.USERAGENT_BROWSER.prototype.analyze = b.analyze)
}(this),
	function(a) {
		var b = [{
				regEx: /MEIZU (MX|M9)|MX[0-9]{0,1}[; ]|M0(4|5)\d|M35\d|M\d note/i,
				brand: "Meizu",
				image: "meizu",
				childItem: [{
					regEx: /(M(04|05|35)\d)/i,
					model: "$1"
				}, {
					regEx: /(MX[0-9]{0,1})/i,
					model: "$1"
				}, {
					regEx: /(m\d Note)/i,
					model: "$1"
				}]
			}, {
				regEx: /MI-ONE|MI[ -]\d/i,
				brand: "Xiaomi",
				image: "xiaomi",
				childItem: [{
					regEx: /MI-ONE/i,
					model: "1"
				}, {
					regEx: /MI[ -]([A-Z0-9]+)/i,
					model: "$1"
				}]
			}, {
				regEx: /HM NOTE|HM \d|Redmi/i,
				brand: "Redmi",
				image: "xiaomi",
				childItem: [{
					regEx: /HM NOTE ([A-Z0-9]+)/i,
					model: "Note $1"
				}, {
					regEx: /HM ([A-Z0-9]+)/i,
					model: "$1"
				}, {
					regEx: /RedMi Note ([A-Z0-9]+)/i,
					model: "Note $1"
				}]
			}, {
				regEx: /BlackBerry/i,
				brand: "BlackBerry",
				image: "blackberry",
				version: {
					start: "blackberry ?"
				}
			}, {
				regEx: /Coolpad/i,
				brand: "CoolPad",
				image: "coolpad",
				version: {
					start: "CoolPad( |_)?",
					item: 2
				}
			}, {
				regEx: /Dell/i,
				brand: "Dell",
				image: "dell",
				childItem: [{
					regEx: /Dell Streak/i,
					model: "Streak"
				}]
			}, {
				regEx: /Hasee/i,
				brand: "Hasee",
				image: "hasee",
				childItem: [{
					regEx: /Hasee (([^;\/]+) Build|([^;\/)]+)[);\/ ])/i,
					model: "$2"
				}]
			}, {
				regEx: /Hisense|HS-(?:U|EG?|I|T|X)[0-9]+[a-z0-9-]*/i,
				brand: "Hisense",
				image: "hisense",
				childItem: [{
					regEx: /(HS-(?:U|EG?|I|T|X)[0-9]+[a-z0-9-]*)/i,
					model: "$1"
				}]
			}, {
				regEx: /HTC|Desire|Rhodium|WMD-50433/i,
				brand: "HTC",
				image: "htc",
				childItem: [{
					regEx: /Desire/i,
					model: "Desire"
				}, {
					regEx: /Rhodium|WMD-50433|HTC[_| ]Touch[_| ]Pro2/i,
					model: "Touch Pro2"
				}, {
					regEx: /HTC[_| ]Touch[_| ]Pro/i,
					model: "Touch Pro"
				}, {
					regEx: /Windows Phone .+ by HTC/i,
					version: {
						start: "Windows Phone ",
						end: " by HTC"
					}
				}],
				version: {
					start: "HTC[ |_|-]?"
				}
			}, {
				regEx: /huawei|Honor|Che\d|H60-L/i,
				brand: "Huawei",
				image: "huawei",
				version: {
					start: "HUAWEI( |_)?",
					item: 2
				},
				childItem: [{
					regEx: /HONOR[ ]?([A-Za-z0-9]{3,4}-[A-Za-z0-9]{3,4})|(Che[0-9]{1}-[a-zA-Z0-9]{4})/i,
					model: "$1"
				}, {
					regEx: /(H60-L\d+)/i,
					model: "$1"
				}]
			}, {
				regEx: /Kindle/i,
				brand: "Amazon",
				model: "Kindle",
				image: "kindle",
				version: {
					start: "Kindle/"
				}
			}, {
				regEx: /K-Touch/i,
				brand: "K-Touch",
				image: "k-touch",
				version: {
					start: "k-touch[ _]"
				}
			}, {
				regEx: /Lenovo|lepad|Yoga/i,
				brand: "Lenovo",
				image: "lenovo",
				childItem: [{
					regEx: "lepad",
					model: "LePad"
				}, {
					regEx: /Yoga( Tablet)?[ |-|\/|_]([.0-9a-zA-Z]+)/i,
					model: "Yoga $2"
				}],
				version: {
					start: "Lenovo[ |-|/|_]"
				}
			}, {
				regEx: /Letv/i,
				brand: "Letv",
				image: "letv",
				version: {
					start: "Letv[- /]"
				}
			}, {
				regEx: /LG/i,
				brand: "LG",
				image: "lg",
				version: {
					start: "LGE?([- /])",
					item: 2
				}
			}, {
				regEx: / Droid|XT720|MOT-|MIB|XOOM/i,
				brand: "Motorola",
				image: "motorola",
				childItem: [{
					regEx: / Droid/i,
					model: "Droid"
				}, {
					regEx: /MOT-|MIB/i,
					version: {
						start: "MOT(O|-)",
						item: 2
					}
				}, {
					regEx: /XOOM/i,
					model: "Xoom"
				}, {
					regEx: /XT720/i,
					model: "XT720"
				}]
			}, {
				regEx: /Microsoft/i,
				brand: "Microsoft",
				image: "microsoft",
				childItem: [{
					regEx: /Lumia/i,
					model: "Lumia",
					version: {
						start: "(Lumia )",
						item: 2
					}
				}]
			}, {
				regEx: /Nintendo/i,
				brand: "Nintendo",
				image: "nintendo",
				childItem: [{
					regEx: /DSi/,
					model: "DSi",
					image: "nintendodsi"
				}, {
					regEx: /DS/,
					model: "DS",
					image: "nintendods"
				}, {
					regEx: /WiiU/,
					model: "Wii U",
					image: "nintendowiiu"
				}, {
					regEx: /Wii/,
					model: "Wii",
					image: "nintendowii"
				}]
			}, {
				regEx: /Nokia/i,
				brand: "Nokia",
				image: "nokia",
				childItem: [{
					regEx: /Nokia 909/i,
					model: "Lumia 1020"
				}, {
					regEx: /IEMobile|WPDesktop|Edge/i,
					model: "Lumia",
					version: {
						start: "(Nokia |Lumia |Nokia;)",
						item: 2
					}
				}],
				version: {
					start: "Nokia",
					item: 1
				}
			}, {
				regEx: /Onda/i,
				brand: "Onda",
				image: "onda"
			}, {
				regEx: /oppo/i,
				brand: "OPPO",
				image: "oppo"
			}, {
				regEx: /A0001|A2005|A3000|E1003|One [A-Z]\d{4}/i,
				brand: "OnePlus",
				image: "oneplus",
				childItem: [{
					regEx: /A0001/,
					model: "1"
				}, {
					regEx: /A2005/,
					model: "2"
				}, {
					regEx: /E1003/,
					model: "X"
				}, {
					regEx: /A3000/,
					model: "3"
				}]
			}, {
				regEx: / Pixi\/| Pre\/|Palm|webos/i,
				brand: "Palm",
				image: "palm",
				childItem: [{
					regEx: /Pixi/i,
					model: "Pixi"
				}, {
					regEx: /Pre/i,
					model: "Pre"
				}]
			}, {
				regEx: /Galaxy Nexus|Smart-?TV|GT-|SM-|SCH-|SHV-|Samsung/i,
				brand: "Samsung",
				image: "samsung",
				childItem: [{
					regEx: /Smart-?TV/i,
					model: "Smart TV"
				}, {
					regEx: /Galaxy Nexus/i,
					model: "Galaxy Nexus"
				}],
				version: {
					start: "(Samsung-(SCH-)?|GT-|SM-|SCH-|SHV-)",
					item: 3
				}
			}, {
				regEx: /PlayStation/i,
				brand: "Sony",
				model: "PlayStation",
				image: "playstation",
				version: {
					start: "PlayStation "
				}
			}, {
				regEx: /SonyEricsson/i,
				brand: "SonyEricsson",
				image: "sonyericsson",
				version: {
					start: "SonyEricsson"
				}
			}, {
				regEx: /TCL/i,
				brand: "TCL",
				image: "tcl",
				version: {
					start: "TCL ?"
				}
			}, {
				regEx: /vivo/i,
				brand: "vivo",
				image: "vivo",
				version: {
					start: "VIVO "
				}
			}, {
				regEx: /Xperia/i,
				brand: "Sony",
				model: "Xperia",
				image: "xperia",
				version: {
					start: "Xperia(-T)?( |_|-)?",
					item: 3
				}
			}, {
				regEx: /zte/i,
				brand: "ZTE",
				image: "zte",
				version: {
					start: "ZTE "
				}
			}, {
				regEx: /Ubuntu; (Mobile|Tablet)/i,
				brand: "Ubuntu",
				image: "ubuntutouch",
				childItem: [{
					regEx: /Mobile/i,
					model: "Phone"
				}, {
					regEx: /Tablet/i,
					model: "Tablet"
				}]
			}, {
				regEx: /Nexus/i,
				brand: "Google",
				model: "Nexus",
				image: "google-nexusone",
				version: {
					start: "Nexus "
				}
			}],
			c = function(a, b) {
				"end" in b.version || (b.version.end = ""), "item" in b.version || (b.version.item = 1);
				var c = new RegExp(b.version.start + "([.0-9a-zA-Z]+)" + b.version.end, "i"),
					d = a.ua.match(c);
				d && (a.model += ("" === a.model ? "" : " ") + d[b.version.item].replace(/_/g, ""))
			},
			d = function(a, b) {
				for(var e = null, f = "", g = null, h = Object.keys(b), i = 0; i < h.length; i++)
					if(g = b[h[i]], e = a.ua.match(g.regEx)) {
						for(var j = Object.keys(g), k = 0; k < j.length; k++) {
							var l = j[k],
								m = g[l];
							switch(l) {
								case "childItem":
								case "version":
								case "regEx":
									break;
								case "brand":
								case "model":
									if(0 === e.length) continue;
									"" !== a[l] && (a[l] += " "), f = m;
									for(var n = 1; n < e.length; n++) f = f.replace(new RegExp("\\$" + n, "g"), e[n]);
									a[l] += f;
									break;
								default:
									a[l] = m
							}
						}
						var o = "version" in g;
						return "childItem" in g && d(a, g.childItem) && (o = !1), o && c(a, g), delete a.addVersion, !0
					}
				return !1
			},
			e = function(a) {
				d(a, b) || (/iPad/i.test(a.ua) ? (a.brand = "Apple", a.model = "iPad", a.image = "ipad") : /iPod/i.test(a.ua) ? (a.brand = "Apple", a.model = "iPod", a.image = "iphone") : /iPhone/i.test(a.ua) ? (a.brand = "Apple", a.model = "iPhone", a.image = "iphone") : /MSIE.+?Windows.+?Trident/i.test(a.ua) && !/Windows ?Phone/i.test(a.ua) ? (a.brand = "", a.model = "", a.image = "null") : a.image = "null")
			},
			f = {};
		f.analyze = function(a) {
			var b = {
				ua: a,
				name: "",
				image: "",
				brand: "",
				model: "",
				dir: "device"
			};
			return e(b), b.name = "" === b.brand && "" === b.model ? "" : b.brand + ("" === b.model ? "" : " ") + b.model, b.full = b.name, b
		}, "undefined" != typeof module && module.exports ? module.exports = f : "undefined" != typeof define && define.amd ? define([], function() {
			return f
		}) : "undefined" != typeof define && define.cmd ? define([], function(a, b, c) {
			c.exports = f
		}) : (a.USERAGENT_DEVICE = function() {}, a.USERAGENT_DEVICE.prototype.analyze = f.analyze)
	}(this),
	function(a) {
		var b = {
				6.4: ["10", "6"],
				"10.0": ["10", "6"],
				6.3: ["8.1", "5"],
				6.2: ["8", "5"],
				6.1: ["7", "4"],
				"6.0": ["Vista", "3"],
				5.2: ["Server 2003", "2"],
				5.1: ["XP", "2"],
				5.01: ["2000 Service Pack 1", "1"],
				"5.0": ["2000", "1"],
				"4.0": ["NT 4.0", "1"],
				3.51: ["NT 3.11", "1"]
			},
			c = new RegExp(["BB10", "BeOS", "DragonFly", "FreeBSD", "Inferno", "SunOS", "Solaris", "J2ME/MIDP", "MorphOS", "NetBSD", "OpenBSD", "Unix", "webOS"].join("|"), "i"),
			d = {
				bb10: {
					name: "BlackBerry OS 10",
					image: "blackberry"
				},
				dragonfly: {
					name: "DragonFly BSD",
					image: "dragonflybsd"
				},
				freebsd: {
					name: "FreeBSD"
				},
				morphos: {
					name: "MorphOS"
				},
				openbsd: {
					name: "OpenBSD"
				},
				netbsd: {
					name: "NetBSD"
				},
				beos: {
					name: "BeOS"
				},
				webos: {
					name: "Palm webOS",
					image: "palm"
				},
				sunos: {
					name: "Solaris",
					image: "solaris"
				},
				"j2me/midp": {
					name: "J2ME/MIDP Device",
					image: "java"
				}
			},
			e = new RegExp(["Arch ?Linux", "Chakra", "Crunchbang", "Debian", "Gentoo", "Kanotix", "Knoppix", "Jolla", "LindowsOS", "Linspire", "Mageia", "Pardus", "Rosa", "Sabayon", "Slackware", "Suse", "VectorLinux", "Venenux", "Xandros", "Zenwalk"].join("|"), "i"),
			f = {
				"arch linux": {
					image: "archlinux",
					name: "Arch Linux"
				},
				archlinux: {
					name: "Arch Linux"
				},
				suse: {
					name: "openSUSE"
				},
				lindowsos: {
					name: "LindowsOS"
				},
				linspire: {
					image: "lindowsos"
				}
			},
			g = {
				centos: ["centos", /.el([.0-9a-zA-Z]+).centos/i],
				fedora: ["fedora", /.fc([.0-9a-zA-Z]+)/i],
				"foresight linux": ["foresight", /Foresight Linux\/([.0-9a-zA-Z]+)/i],
				"linux mint": ["linuxmint", /Linux Mint\/([.0-9a-zA-Z]+)/i],
				mandriva: ["mandriva", /mdv\/([.0-9a-zA-Z]+)/i],
				moonos: ["moonos", /moonos\/([.0-9a-zA-Z]+)/i]
			},
			h = new RegExp("(" + Object.keys(g).join("|") + ")", "i"),
			i = function(a, c) {
				a.full += " " + b[c][0], a.image = "win-" + b[c][1], a.version = c
			},
			j = function(a) {
				a.full = "Windows", a.name = "Windows", a.image = "win-2", a.version = "";
				var c = null;
				if(/Windows Phone|WPDesktop|ZuneWP7|WP7/i.test(a.ua)) {
					if(a.name += " Phone", a.image = "windowsphone", c = a.ua.match(/Windows Phone (OS )?([0-9\.]+)/i), null !== c) {
						a.version = c[2];
						var d = parseInt(a.version);
						7 === d ? a.image = "wp7" : 10 === d && (a.name = "Windows", a.version = "10 Mobile", a.image = "win-6")
					}
					a.full = a.name + ("" === a.version ? "" : " " + a.version)
				} else /Windows NT/i.test(a.ua) && (a.name = "Windows NT", c = a.ua.match(/Windows NT (\d+\.\d+)/i), null !== c && b[c[1]] && i(a, c[1]));
				return "Windows" !== a.full || void(/Windows XP/i.test(a.ua) ? i(a, "5.1") : /Windows 2000/i.test(a.ua) ? i(a, "5.0") : /WinNT4.0/i.test(a.ua) ? i(a, "4.0") : /WinNT3.51/i.test(a.ua) ? i(a, "3.51") : /Win(dows )?3.11|Win16/i.test(a.ua) ? (a.full += " 3.11", a.image = "win-1") : /Windows 3.1/i.test(a.ua) ? (a.full += " 3.1", a.image = "win-1") : /Win 9x 4.90|Windows ME/i.test(a.ua) ? (a.full += " Me", a.image = "win-1") : /Win98/i.test(a.ua) ? (a.full += " 98 SE", a.image = "win-1") : /Windows (98|4\.10)/i.test(a.ua) ? (a.full += " 98", a.image = "win-1") : /Windows 95/i.test(a.ua) || /Win95/i.test(a.ua) ? (a.full += " 95", a.image = "win-1") : /Windows CE|Windows .+Mobile/i.test(a.ua) ? (a.full += " CE", a.image = "win-2") : /WM5/i.test(a.ua) ? (a.name += " Mobile", a.version = "5", a.full = a.name + " " + a.version, a.image = "win-phone") : /WindowsMobile/i.test(a.ua) && (a.name += " Mobile", a.full = a.name, a.image = "win-phone"))
			},
			k = function(a) {
				a.name = "", a.image = "", a.version = "";
				var b = null,
					c = a.ua.match(e),
					d = "";
				if(h.lastIndex = 0, null !== c) d = c[0].toLowerCase(), a.name = d.replace(/(\w)/, function(a) {
					return a.toUpperCase()
				}), a.image = d, f[d] && (a.name = f[d].name || a.name, a.image = f[d].image || a.image);
				else if(/(L|K|X|Ed)?Ubuntu/i.test(a.ua)) {
					if(a.name = "Ubuntu", b = a.ua.match(/Ubuntu[\/| ]([.0-9]+[.0-9a-zA-Z]+)/i), b && (a.version = b[1], parseInt(a.version) < 10 && (a.image = "ubuntu-1")), "" === a.image && (a.image = "ubuntu-2"), b = a.ua.match(/(L|K|X|Ed)Ubuntu/i)) {
						var i = b[1].toLowerCase();
						a.name = i + a.name, a.name = a.name.toLowerCase().replace(/(\w)/, function(a) {
							return a.toUpperCase()
						}), a.image = i + a.image
					}
				} else h.test(a.ua) ? (b = a.ua.match(h), d = b[1].toLowerCase(), a.name = b[1], b = a.ua.match(g[d][1]), b && (a.version = b[1]), a.image = g[d][0]) : /Red Hat/i.test(a.ua) || /RedHat/i.test(a.ua) ? (a.name = "Red Hat", b = a.ua.match(/.el([._0-9a-zA-Z]+)/i), b && (a.name += " Enterprise Linux", a.version = b[1].replace(/_/g, ".")), a.image = "red-hat") : (a.name = "GNU/Linux", a.image = "linux");
				a.full = a.name, "" !== a.version && (a.full += " " + a.version)
			},
			l = function(a) {
				a.name = "", a.image = "", a.version = "", a.full = "";
				var b, e = a.ua.match(c);
				if(null !== e) {
					var f = e[0].toLowerCase();
					a.name = f.replace(/(\w)/, function(a) {
						return a.toUpperCase()
					}), a.image = f, d[f] && (a.name = d[f].name || a.name, a.image = d[f].image || a.image)
				} else if(/Android|ADR /i.test(a.ua)) a.name = "Android", a.image = "android", b = a.ua.match(/(Android|Adr)[ |\/]([.0-9]+)/i), b && (a.version = b[2]);
				else if(/Tizen/i.test(a.ua)) a.name = "Tizen", a.image = "tizen";
				else if(/(iPhone|CPU) OS/.test(a.ua)) a.name = "iOS", a.image = "mac-3", b = a.ua.match(/(iPhone|CPU) OS ([._0-9]+)/i), b && (a.version = b[2].replace(/_/g, "."));
				else if(/AmigaOS/i.test(a.ua)) a.name = "AmigaOS", b = a.ua.match(/AmigaOS ([.0-9a-zA-Z]+)/i), b && (a.version = b[1]), a.image = "amigaos";
				else if(/\b(?!Mi)CrOS(?!oft)/i.test(a.ua)) a.name = "Google Chrome OS", a.image = "chromeos";
				else if(/IRIX/i.test(a.ua)) a.name = "IRIX", b = a.ua.match(/IRIX(64)? ([.0-9a-zA-Z]+)/i), b && (void 0 !== b[1] && "" !== b[1] && (a.x64 = !0), void 0 !== b[2] && "" !== b[2] && (a.version = b[2])), a.image = "irix";
				else if(/Mac/i.test(a.ua) || /Darwin/i.test(a.ua))
					if(b = a.ua.match(/(Mac OS ?X)/i)) {
						a.version = a.ua.substr(a.ua.toLowerCase().indexOf(b[1].toLowerCase())), a.version = a.version.substr(0, a.version.indexOf(")")), a.version.indexOf(";") > 0 && (a.version = a.version.substr(0, a.version.indexOf(";"))), a.version = a.version.replace(/_/g, "."), a.version = a.version.replace(/Mac OS ?X ?/, "");
						var g = a.version.split(".");
						if(g.length > 1) {
							var h = parseInt(g[0]),
								i = parseInt(g[1]);
							h >= 10 && i >= 12 && (a.name = "macOS")
						}
						"" === a.name && (a.name = "Mac OS X"), a.full = a.name + " " + a.version, a.image = "Mac OSX" === b[1] ? "mac-2" : "mac-3"
					} else /Darwin/i.test(a.ua) ? (a.name = "Mac OS Darwin", a.image = "mac-1") : (a.name = "Macintosh", a.image = "mac-1");
				else /Meego/i.test(a.ua) ? (a.name = "Meego", a.image = "meego") : /RISC OS/i.test(a.ua) ? (a.name = "RISC OS", a.image = "risc", b = a.ua.match(/RISC OS ([.0-9a-zA-Z]+)/i), b && (a.version = b[1])) : /Symb(ian)?(OS)?/i.test(a.ua) ? (a.name = "SymbianOS", b = a.ua.match(/Symb(ian)?(OS)?\/([.0-9a-zA-Z]+)/i), b && (a.version = b[3]), a.image = "symbian") : (a.name = "Unknown", a.image = "null");
				a.full = a.name + ("" === a.version ? "" : " " + a.version)
			},
			m = {};
		m.analyze = function(a) {
			var b = {
				ua: a,
				name: "",
				version: "",
				full: "",
				windows: !1,
				linux: !1,
				x64: !1,
				dir: "os"
			};
			return /x86_64|Win64; x64|WOW64/i.test(b.ua) && (b.x64 = !0), /Windows|Win(NT|32|95|98|16)|ZuneWP7|WPDesktop/i.test(b.ua) ? (b.windows = !0, j(b)) : /Linux/i.test(b.ua) && !/Android|ADR|Tizen/.test(b.ua) ? (b.linux = !0, k(b)) : l(b), "" === b.full && (b.full = b.name), b.x64 && (b.full += " x64"), b
		}, "undefined" != typeof module && module.exports ? module.exports = m : "undefined" != typeof define && define.amd ? define([], function() {
			return m
		}) : "undefined" != typeof define && define.cmd ? define([], function(a, b, c) {
			c.exports = m
		}) : (a.USERAGENT_OS = function() {}, a.USERAGENT_OS.prototype.analyze = m.analyze)
	}(this),
	function(a) {
		var b = "undefined" != typeof module && module.exports,
			c = "undefined" != typeof define && define.cmd,
			d = "undefined" != typeof define && define.amd,
			e = {};
		e.version = "0.5.6", e.publishDate = "20170104", e.analyze = function(a) {
			var b = {};
			return b.ua = a, this.osDetect && (b.os = this.osDetect.analyze(a)), this.deviceDetect && (b.device = this.deviceDetect.analyze(a)), this.browserDetect && (b.browser = this.browserDetect.analyze(a)), b.device && (b.platform = b.device), b.device && b.os && "" === b.device.name && (b.platform = b.os), b
		};
		var f = function(a, b, c, d) {
			a.osDetect = b, a.deviceDetect = c, a.browserDetect = d
		};
		if(b) {
			if(process.env.UAJS_COV) {
				var g = ["-cov/os", "-cov/device", "-cov/browser"];
				f(e, require("./lib" + g[0]), require("./lib" + g[1]), require("./lib" + g[2]))
			} else f(e, require("./lib/os"), require("./lib/device"), require("./lib/browser"));
			module.exports = e
		} else d ? define(["./lib/os", "./lib/device", "./lib/browser"], function(a, b, c) {
			return f(e, a, b, c), e
		}) : c ? define(function(a, b, c) {
			f(e, a("./lib/os"), a("./lib/device"), a("./lib/browser")), c.exports = e
		}) : ("undefined" != typeof USERAGENT_OS && (e.osDetect = new USERAGENT_OS), "undefined" != typeof USERAGENT_DEVICE && (e.deviceDetect = new USERAGENT_DEVICE), "undefined" != typeof USERAGENT_BROWSER && (e.browserDetect = new USERAGENT_BROWSER), a.USERAGENT = e)
	}(this);

var trak = (function() {
	'use strict';

	/**
	 * trak.clean()
	 * Cleans the input replacing spaces with a specified delimeter (see trak.options) and converts to lower case
	 * @param  string str
	 * @return string cleaned string
	 */
	var clean = function(str) {
		if(!str) {
			return '';
		}
		if(!trak.options.clean) {
			return wildcard.call(this, str);
		} else {
			return wildcard.call(this, str).toString().replace(/\s|'|"/g, settings.delimeter).toLowerCase();
		}
	};

	/**
	 * trak.event()
	 * @param  object options     See getOptions() function for available items
	 */
	var event = function(options) {
		var opts = getOptions(options);

		// Cache the options
		var appId = trak.options.appId;
		var openId = trak.options.openId;
		var userId = trak.options.userId;
		//这里的openId让他在cookie中获取
		//		var openId = getCookie('openId');
		//不允许自定义事件修改code
		var category = jingTrack.q[0][0].category;
		var action = clean.call(this, opts.action);

		var data = opts.data;
		if(!appId) {
			console.log("don't have appId!");
			return;
		}
		if(Array.isArray(data)) {
			data = {};
		}
		for(var key in umt) {
			if(getCookie(umt[key])) {
				var umt_key = umt[key];
				data[umt_key] = getCookie(umt_key);
			}
		}

		//visitor tracking
		if(visitorUuid) {
			data["jtrak_visitor_id"] = visitorUuid;
		} else {
			data["jtrak_visitor_id"] = "guest";
		}

		// browser features such as: pdf=1&qt=0&realp=0&wma=0&dir=0&fla=1&java=0&gears=0&ag=0&cookie=1
		for(var i in browserFeatures) {
			if(Object.prototype.hasOwnProperty.call(browserFeatures, i)) {
				data["jtrak_" + i] = browserFeatures[i];
			}
		}

		//useragent
		data["jtrak_is_wechat"] = isWeixin;
		if (ua !== '') {
            data["jtrak_useragent"] = ua.ua;
            data["jtrak_browserName"] = ua.browser.name;
            data["jtrak_browserVersion"] = ua.browser.version;
            data["jtrak_os"] = ua.os.name;
		}
        B_href = window.location.href
		//thisUrl
		//这里获取域名后面， ？前面的内容；
		var B_href_thisUrl2;
		var url_start2, url_end2;
		//获取第三个“/”， 和第一个“？”的位置
		function nthIndexOf2(str, c, num) {
			var x = str.indexOf(c);
			for(var i = 0; i < num; i++) {
				x = str.indexOf(c, x + 1);
			}
			return x;
		}
		url_start2 = nthIndexOf2(B_href, "/", 2);
		url_end2 = nthIndexOf2(B_href, "?", 0);
		//取到之后截取字符串；
		//判断有没有？
		if(url_end2 == -1) {
			B_href_thisUrl2 = B_href.substring(url_start2)
		} else {
			B_href_thisUrl2 = B_href.substring(url_start2, url_end2);
		}
		//用来自定义事件
		data["jtrak_thisUrl"] = B_href_thisUrl2;
		data["jtrak_titleName"] = document.title;
		var domainNum = find(locationArray[1], '/', 2)
		var jtrak_domain = locationArray[1].substring(0, domainNum);
		data["jtrak_domain"] = jtrak_domain;
		data["jtrak_original_url"] = window.location.href;
		//jing web tracking openid logic
		if( isWeixin == "NO" && (openId == '' || openId == 'undefined' || !isDefined(openId) || (typeof(openId) !== 'string') || openId == null || openId.length !== 28)) {
			if(visitorUuid) {
				if(jingTrack.q[0][0].openId !== ""){
					setCookie('jing' + jingTrack.q[0][0].appId + 'openId', jingTrack.q[0][0].openId, 1)
					trak.options.openId = jingTrack.q[0][0].openId;
				}else{
					openId = "jingwebtrack" + visitorUuid.substring(0, 16);
					//我需要在这里把openId挂在cookie上
					setCookie('jing' + jingTrack.q[0][0].appId + 'openId', openId, 1)
					if(trak.options.openId == "") {
						trak.options.openId = openId;
					}
				}
			}
		}
        var uncodeuserid = ''
        if (jingTrack.q[0][0].getuseridfromcookie) {
            uncodeuserid = unescape(getCookie(jingTrack.q[0][0].getuseridfromcookie))
            uncodeuserid = (uncodeuserid === '' || uncodeuserid === null ||uncodeuserid === undefined) ? '' : eval('(' + uncodeuserid + ')')
            uncodeuserid = (uncodeuserid === '' || uncodeuserid === null || uncodeuserid === undefined) ? '' : (uncodeuserid.user === '' || uncodeuserid.user === null || uncodeuserid.user === undefined) ? '' : (uncodeuserid.user.name === '' || uncodeuserid.user.name === null || uncodeuserid.user.name === undefined) ? '' : uncodeuserid.user.name
        }
		opts.appId = appId;
        opts.userId = (userId === null || userId === undefined || userId === '') ? uncodeuserid : userId;
		opts.openId = openId;
		opts.category = category;
		opts.action = action;
        opts.clientMid = ''
        if (jingTrack.q[0][0].clientMid) {
            opts.clientMid = jingTrack.q[0][0].clientMid
        }


		if(settings.additionalTypes !== undefined) {
			settings.additionalTypes(opts);
		}

		if(settings.debug) {
			console.debug('Debug message:\n appId:',  appId, '\n userId:', userId,'\n openId:', openId, '\n Category:', category, '\n Action:', action, '\n clientMid:', clientMid, '\n data:', data);
		}

		var base64JsonStr = JingsocialBase64.encode(JSON.stringify(opts));
		ajaxTrack.call(this, base64JsonStr);

	};

	var enableTrackPage = function(category) {
		pageViewCategory = category;
		enableTrackPageView = true;
	}

	var setCookie = function(name, value, days) {
		var expires = "";
		if(days) {
			var date = new Date();
			date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
			expires = "; expires=" + date.toUTCString();
		}
		document.cookie = name + "=" + (value || "") + expires + "; path=/";
	}

	var delCookie = function (name)
	{
		var exp = new Date();
		exp.setTime(exp.getTime() - 1);
		var cval=getCookie(name);
		if(cval!=null)
			document.cookie= name + "="+cval+";expires="+exp.toGMTString() + "; path=/";
	}

	var getCookie = function(name) {
		var nameEQ = name + "=";
		var ca = document.cookie.split(';');
		for(var i = 0; i < ca.length; i++) {
			var c = ca[i];
			while(c.charAt(0) == ' ') c = c.substring(1, c.length);
			if(c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
		}
		return null;
	}

	var getParameterByName = function(name, url) {
		if(!url) url = window.location.href;
		if(typeof(name) != 'string') return '';
		name = name.replace(/[\[\]]/g, "\\$&");
		var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
			results = regex.exec(url);
		if(!results) return null;
		if(!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, " "));
	}

	var eraseCookie = function(name) {
		document.cookie = name + '=; Max-Age=-99999999;';
	}

	/**
	 *
	 */
	var ajaxTrack = function(data) {
		/*
		 * 创建XMLHttpRequest方法
		 * @function createXMLHttpRequest
		 * @return XMLHttpRequest对象
		 */
		function createXMLHttpRequest() {
			if(window.ActiveXObject) {
				return new ActiveXObject("Microsoft.XMLHTTP");
			} else if(window.XMLHttpRequest) {
				return new XMLHttpRequest();
			}
		}

		/*
		 * 监听响应并进行处理方法
		 * @function handleStateChange
		 * @parmar action 处理函数
		 */
		function handleStateChange() {
			if(xmlHttp.readyState === 4) {
				var str = 'response:';
				str += xmlHttp.responseText;
			}
		}

		//创建XMLHttpRequest对象
		var xmlHttp = createXMLHttpRequest();
		//监听响应并进行处理
		xmlHttp.onreadystatechange = handleStateChange;
		//创建请求
		xmlHttp.open('GET', 'https://tracking.jingsocial.com/apiv2/jingsocial/trackV4?data=' + data, true);
		//发送请求
		xmlHttp.send();
	}

	/**
	 * attrEvent
	 * This is used when elements with the [data-trak] is present.
	 * It calls trak.event()
	 * Usage in your js code:
	 * > trak.attrEvent.call(this);
	 */
	var attrEvent = function() {
		var trakWithJs = this.getAttribute('data-trakwithjs') !== null ? true : false;
		if(!trakWithJs) {
			var _options = JSON.parse(this.getAttribute('data-trak'));
			event.call(this, _options);
		}
	};

	/**
	 * Function to convert wildcards into real values
	 * @param  string str
	 * @return string     The converted ouput from str
	 */
	var wildcard = function(str) {
		var output;

		switch(str) {
			case 'page.title':
				output = document.title;
				break;
			case 'page.href':
				output = window.location.href;
				break;
			case 'link.href':
				output = this.href;
				break;
			case 'link.title':
				output = this.title;
				break;
			case 'referrer':
				output = document.referrer ? document.referrer : 'No referrer';
				break;
			default:
				output = str;
				break;
		}
		return output;
	};

	/**
	 * getOptions
	 * Get all the options
	 */
	var getOptions = function(opts) {
		return {
			appId: opts && opts.appId || '',
			userId: opts && opts.userId || '',
			openId: opts && opts.openId || '',
			category: opts && opts.category || '',
			action: opts && opts.action || '',
			data: opts && opts.data || {}
		};
	};

	/**
	 * trak.options
	 * These are the default options for trak.js
	 * To override them, reassign these values in your code, see
	 * https://gist.github.com/mrmartineau/24ae259f373e6dbda66f for an example
	 * @type {Object}
	 */
	var settings = {
		appId: '',
		userId: '',
		openId: '',
		clean: false, // trak.options.clean     = false
		delimeter: '_', // trak.options.delimeter = '-'
		additionalTypes: undefined,
		debug: false
	};

	var umt = ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term', 'jtrak_utm_source', 'jtrak_utm_campaign'];

	var documentAlias = document,
		windowAlias = window,
		navigatorAlias = navigator,
		browserFeatures = {},
		screenAlias = screen,
		visitorUuid = '',
		enableTrackPageView = false,
		pageViewCategory = "PageView",
		encodeWrapper = windowAlias.encodeURIComponent,
		decodeWrapper = windowAlias.decodeURIComponent;
	var configCookieNamePrefix = '_jing_';
	var locationArray = urlFixup(documentAlias.domain, windowAlias.location.href, getReferrer());
	var domainAlias = domainFixup(locationArray[0]);
	var locationHrefAlias = safeDecodeWrapper(locationArray[1]);
	var configReferrerUrl = safeDecodeWrapper(locationArray[2]);
	// 这个数组是获取IP和网址的

	//获取指定字符在字符串中第N次出现的位置
	function find(str,cha,num){
		var x=str.indexOf(cha);
		for(var i=0;i<num;i++){
			x=str.indexOf(cha,x+1);
		}
		return x;
	}
	var domainNum = find(locationArray[1], '/', 2)
	var jtrak_domain = locationArray[1].substring(0, domainNum)
	let pageTitle = document.title;
	// 截取字符串第N个前面的

    var ua
    if (window.USERAGENT !== undefined) {
        ua = window.USERAGENT.analyze(navigatorAlias.userAgent)
    } else {
        ua = ''
    }
	var isWeixin = is_weixin();
	var hash = sha1;

	function urlFixup(hostName, href, referrer) {
		if(!hostName) {
			hostName = '';
		}

		if(!href) {
			href = '';
		}

		if(hostName === 'translate.googleusercontent.com') { // Google
			if(referrer === '') {
				referrer = href;
			}

			href = getUrlParameter(href, 'u');
			hostName = getHostName(href);
		} else if(hostName === 'cc.bingj.com' || // Bing
			hostName === 'webcache.googleusercontent.com' || // Google
			hostName.slice(0, 5) === '74.6.') { // Yahoo (via Inktomi 74.6.0.0/16)
			href = documentAlias.links[0].href;
			hostName = getHostName(href);
		}

		return [hostName, href, referrer];
	}

	function getHostName(url) {
		// scheme : // [username [: password] @] hostame [: port] [/ [path] [? query] [# fragment]]
		var e = new RegExp('^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)'),
			matches = e.exec(url);

		return matches ? matches[1] : url;
	}

	function getUrlParameter(url, name) {
		var regexSearch = "[\\?&#]" + name + "=([^&#]*)";
		var regex = new RegExp(regexSearch);
		var results = regex.exec(url);
		return results ? decodeWrapper(results[1]) : '';
	}

	function hasCookies() {
		if(!isDefined(navigatorAlias.cookieEnabled)) {
			var testCookieName = getCookieName('testcookie');
			setCookie(testCookieName, '1');

			return getCookie(testCookieName) === '1' ? '1' : '0';
		}

		return navigatorAlias.cookieEnabled ? '1' : '0';
	}

	function is_weixin() {
		var ua = navigator.userAgent.toLowerCase();
		if(ua.match(/MicroMessenger/i) == "micromessenger") {
			if(ua.match(/wxwork/i) == "wxwork"){
				return "NO";
			}else{
				return "YES";
			}
		} else {
			return "NO";
		}
	}

	function isFunction(property) {
		return typeof property === 'function';
	}

	/*
	 * Browser features (plugins, resolution, cookies)
	 */
	function detectBrowserFeatures() {
		var i,
			mimeType

		// detect browser features except IE < 11 (IE 11 user agent is no longer MSIE)
		if(!((new RegExp('MSIE')).test(navigatorAlias.userAgent))) {
			// general plugin detection
			if(navigatorAlias.mimeTypes && navigatorAlias.mimeTypes.length) {
				// for(i in pluginMap) {
				// 	if(Object.prototype.hasOwnProperty.call(pluginMap, i)) {
				// 		mimeType = navigatorAlias.mimeTypes[pluginMap[i]];
				// 		browserFeatures[i] = (mimeType && mimeType.enabledPlugin) ? '1' : '0';
				// 	}
				// }
			}

			// Safari and Opera
			// IE6/IE7 navigator.javaEnabled can't be aliased, so test directly
			// on Edge navigator.javaEnabled() always returns `true`, so ignore it
			if(!((new RegExp('Edge[ /](\\d+[\\.\\d]+)')).test(navigatorAlias.userAgent)) &&
				typeof navigator.javaEnabled !== 'unknown' &&
				isDefined(navigatorAlias.javaEnabled) &&
				navigatorAlias.javaEnabled()) {
				// browserFeatures.java = '1';
			}

			// Firefox
			if(isFunction(windowAlias.GearsFactory)) {
				// browserFeatures.gears = '1';
			}

			// other browser features
			browserFeatures.cookie = hasCookies();
		}

		var width = parseInt(screenAlias.width, 10);
		var height = parseInt(screenAlias.height, 10);
		browserFeatures.res = parseInt(width, 10) + 'x' + parseInt(height, 10);
	}

	function getReferrer() {
		var referrer = '';

		try {
			referrer = windowAlias.top.document.referrer;
		} catch(e) {
			if(windowAlias.parent) {
				try {
					referrer = windowAlias.parent.document.referrer;
				} catch(e2) {
					referrer = '';
				}
			}
		}

		if(referrer === '') {
			referrer = documentAlias.referrer;
		}

		return referrer;
	}

	function domainFixup(domain) {
		var dl = domain.length;

		// remove trailing '.'
		if(domain.charAt(--dl) === '.') {
			domain = domain.slice(0, dl);
		}

		// remove leading '*'
		if(domain.slice(0, 2) === '*.') {
			domain = domain.slice(1);
		}

		if(domain.indexOf('/') !== -1) {
			domain = domain.substr(0, domain.indexOf('/'));
		}

		return domain;
	}

	function sha1(str) {
		// +   original by: Webtoolkit.info (http://www.webtoolkit.info/)
		// + namespaced by: Michael White (http://getsprink.com)
		// +      input by: Brett Zamir (http://brett-zamir.me)
		// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
		// +   jslinted by: Anthon Pang (http://piwik.org)

		var
			rotate_left = function(n, s) {
				return(n << s) | (n >>> (32 - s));
			},

			cvt_hex = function(val) {
				var strout = '',
					i,
					v;

				for(i = 7; i >= 0; i--) {
					v = (val >>> (i * 4)) & 0x0f;
					strout += v.toString(16);
				}

				return strout;
			},

			blockstart,
			i,
			j,
			W = [],
			H0 = 0x67452301,
			H1 = 0xEFCDAB89,
			H2 = 0x98BADCFE,
			H3 = 0x10325476,
			H4 = 0xC3D2E1F0,
			A,
			B,
			C,
			D,
			E,
			temp,
			str_len,
			word_array = [];

		str = utf8_encode(str);
		str_len = str.length;

		for(i = 0; i < str_len - 3; i += 4) {
			j = str.charCodeAt(i) << 24 | str.charCodeAt(i + 1) << 16 |
				str.charCodeAt(i + 2) << 8 | str.charCodeAt(i + 3);
			word_array.push(j);
		}

		switch(str_len & 3) {
			case 0:
				i = 0x080000000;
				break;
			case 1:
				i = str.charCodeAt(str_len - 1) << 24 | 0x0800000;
				break;
			case 2:
				i = str.charCodeAt(str_len - 2) << 24 | str.charCodeAt(str_len - 1) << 16 | 0x08000;
				break;
			case 3:
				i = str.charCodeAt(str_len - 3) << 24 | str.charCodeAt(str_len - 2) << 16 | str.charCodeAt(str_len - 1) << 8 | 0x80;
				break;
		}

		word_array.push(i);

		while((word_array.length & 15) !== 14) {
			word_array.push(0);
		}

		word_array.push(str_len >>> 29);
		word_array.push((str_len << 3) & 0x0ffffffff);

		for(blockstart = 0; blockstart < word_array.length; blockstart += 16) {
			for(i = 0; i < 16; i++) {
				W[i] = word_array[blockstart + i];
			}

			for(i = 16; i <= 79; i++) {
				W[i] = rotate_left(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1);
			}

			A = H0;
			B = H1;
			C = H2;
			D = H3;
			E = H4;

			for(i = 0; i <= 19; i++) {
				temp = (rotate_left(A, 5) + ((B & C) | (~B & D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;
				E = D;
				D = C;
				C = rotate_left(B, 30);
				B = A;
				A = temp;
			}

			for(i = 20; i <= 39; i++) {
				temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;
				E = D;
				D = C;
				C = rotate_left(B, 30);
				B = A;
				A = temp;
			}

			for(i = 40; i <= 59; i++) {
				temp = (rotate_left(A, 5) + ((B & C) | (B & D) | (C & D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;
				E = D;
				D = C;
				C = rotate_left(B, 30);
				B = A;
				A = temp;
			}

			for(i = 60; i <= 79; i++) {
				temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;
				E = D;
				D = C;
				C = rotate_left(B, 30);
				B = A;
				A = temp;
			}

			H0 = (H0 + A) & 0x0ffffffff;
			H1 = (H1 + B) & 0x0ffffffff;
			H2 = (H2 + C) & 0x0ffffffff;
			H3 = (H3 + D) & 0x0ffffffff;
			H4 = (H4 + E) & 0x0ffffffff;
		}

		temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);

		return temp.toLowerCase();
	}

	function utf8_encode(argString) {
		return unescape(encodeWrapper(argString));
	}

	function getCookieName(baseName) {
		var domainHash = hash(domainAlias + '/').slice(0, 4); // 4 hexits = 16 bits
		return configCookieNamePrefix + baseName + '.' + domainHash;
	}

	function safeDecodeWrapper(url) {
		try {
			return decodeWrapper(url);
		} catch(e) {
			return unescape(url);
		}
	}
	/*
	 * Is property defined?
	 */
	function isDefined(property) {
		// workaround https://github.com/douglascrockford/JSLint/commit/24f63ada2f9d7ad65afc90e6d949f631935c2480
		var propertyType = typeof property;

		return propertyType !== 'undefined';
	}

	function isObject(property) {
		return typeof property === 'object';
	}

	function isString(property) {
		return typeof property === 'string' || property instanceof String;
	}

	function titleFixup(title) {
		title = title && title.text ? title.text : title;

		if(!isString(title)) {
			var tmp = documentAlias.getElementsByTagName('title');

			if(tmp && isDefined(tmp[0])) {
				title = tmp[0].text;
			}
		}

		return title;
	}
	/*
	 * Load visitor ID cookie
	 */
	function loadVisitorIdCookie() {
		var configVisitorCookieTimeout = 365; // 365 days
		var cookieValue;
		var visitorIdCookieName = getCookieName('id'),
			id = getCookie(visitorIdCookieName);
		if(id) {
			cookieValue = id.split('.');
			if(isDefined(cookieValue[0])) {
				cookieValue = cookieValue[0];
				return cookieValue;
			}
		}
		var uuid = generateRandomUuid();
		setCookie(visitorIdCookieName, uuid, configVisitorCookieTimeout);
		return uuid;
	}

	/*
	 * Generate a pseudo-unique ID to fingerprint this user
	 * 16 hexits = 64 bits
	 * note: this isn't a RFC4122-compliant UUID
	 */
	function generateRandomUuid() {
		return hash(
			(navigatorAlias.userAgent || '') +
			(navigatorAlias.platform || '') +
			JSON.stringify(browserFeatures) +
			(new Date()).getTime() +
			Math.random()
		).slice(0, 16);
	}

	function removeUrlParameter(url, name) {
		url = String(url);

		if(url.indexOf('?' + name + '=') === -1 && url.indexOf('&' + name + '=') === -1) {
			// nothing to remove, url does not contain this parameter
			return url;
		}

		var searchPos = url.indexOf('?');
		if(searchPos === -1) {
			// nothing to remove, no query parameters
			return url;
		}

		var queryString = url.substr(searchPos + 1);
		var baseUrl = url.substr(0, searchPos);

		if(queryString) {
			var urlHash = '';
			var hashPos = queryString.indexOf('#');
			if(hashPos !== -1) {
				urlHash = queryString.substr(hashPos + 1);
				queryString = queryString.substr(0, hashPos);
			}

			var param;
			var paramsArr = queryString.split('&');
			var i = paramsArr.length - 1;

			for(i; i >= 0; i--) {
				param = paramsArr[i].split('=')[0];
				if(param === name) {
					paramsArr.splice(i, 1);
				}
			}

			var newQueryString = paramsArr.join('&');

			if(newQueryString) {
				baseUrl = baseUrl + '?' + newQueryString;
			}

			if(urlHash) {
				baseUrl += '#' + urlHash;
			}
		}

		return baseUrl;
	}

	function purify(url) {
		url = removeUrlParameter(url, "pk_vid");
		return url;
	}
    // 用户的自定义事件
    var custom_event = function (action, data) {
        event({
            action: action,
            data: data
        });
    }
	//封装一个函数, 用来处理元素点击或者失去焦点的事件
	var Bruce_disp = function(element, options) {
//		alert('我能触发pageView')
		//这里需要传进来一个值,这个值是获取到的inputs或者buttons
        var oBody = document.getElementsByTagName("body")[0]
        var aInputs = oBody.getElementsByTagName("input");
        var aAs = oBody.getElementsByTagName("a");
        var aTextareas = oBody.getElementsByTagName("textarea");
        var aButtons = oBody.getElementsByTagName("button");
        var aSelects = oBody.getElementsByTagName("select");
        var unTrackId = jingTrack.q[0][0].unTrackId ? jingTrack.q[0][0].unTrackId : []
        var trackingClass = jingTrack.q[0][0].className ? jingTrack.q[0][0].className : []
		//这里定义一个Bruce_affair，接收element对应的dom节点
		var Bruce_affair;
		//判断element的类型
        var timeoutId = 0
        var isSubmit
        oBody.onmousedown = function (ev) {
            var ev = ev || window.event;
            var numbB = 0
            isSubmit = true
            let evPath = ev.path || (ev.composedPath && ev.composedPath())
            for (let i = 0; i < unTrackId.length; i++) {
                for (let y = 0; y < evPath.length; y++) {
                    if (unTrackId[i] === evPath[y].id) {
                        isSubmit = false
                        break
                    }
                }
            }
            for (let i = 0; i < evPath.length; i++) {
                // 这里判断并获取想要获取的class， 优先级高于不想获取的ID
                if (trackingClass.length > 0) {
                    for (let y = 0; y < trackingClass.length; y++) {
                        // 这里要吧className转换成数组一一判断
                        let classArr = evPath[i].className ? evPath[i].className.split(' ') : []
                        for (let z = 0; z < classArr.length; z++) {
                            if (classArr[z] === trackingClass[y]) {
                                Bruce_use_ajax(evPath[i])
                            }
                        }
                    }
                }
                if ((evPath[i].tagName === 'BUTTON' || evPath[i].tagName === 'A' || evPath[i].tagName === 'LI' || (evPath[i].tagName === 'INPUT' && evPath[i].type === 'submit')) && isSubmit) {
                    numbB = i
                    // 检查是否设置了非默认获取
                    if (jingTrack.q[0][0].stopTracking) {
                    } else {
                        Bruce_use_ajax(evPath[numbB])
                    }
                    break
                }
            }
        }
        oBody.onchange = function (ev) {
            var ev = ev || window.event;
            let evPath = ev.path || (ev.composedPath && ev.composedPath())
            isSubmit = true
            var ev = ev || window.event;
            for (let i = 0; i < unTrackId.length; i++) {
                for (let y = 0; y < evPath.length; y++) {
                    if (unTrackId[i] === evPath[y].id) {
                        isSubmit = false
                    }
                }
            }
            if (isSubmit) {
                // 检查是否设置了非默认获取
                if (jingTrack.q[0][0].stopTracking) {
                } else {
                    Bruce_use_ajax(evPath[0])
                }
            }
        }
		//定义一个Bruce_use_ajax， 用来给data存储数据
		var Bruce_use_ajax = function(_this) {
			var titleName = document.title;
			var isVOrH;

			var action_name;
			//判断是value还是innerHTML
			if(_this.tagName == "INPUT" || _this.tagName == "TEXTAREA") {
				//如果是password， 就让value传过去xxx
				if(_this.type == "password") {
					isVOrH = "xxx";
					//这里没有写action_name， 所以获取不到type为password的任何值
				} else {
					isVOrH = _this.value;
					action_name = "changeOn";
				}
			} else if(_this.tagName == "A" || _this.tagName == "BUTTON" || _this.tagName == "LI" || _this.tagName == "I") {
				isVOrH = _this.innerHTML;
				action_name = "clickOn";
			} else if(_this.tagName == "SELECT") {
				var index = _this.selectedIndex
				isVOrH = _this.options[index].text;
				action_name = "changeOn";
			} else {
                action_name = "clickOn";
            }
			var date = new Date();
			var data = {};
            B_href = window.location.href
			data["jtrak_content"] = isVOrH;
			data["jtrak_tagName"] = _this.tagName;
			data["jtrak_date"] = date;
			data["jtrak_titleName"] = titleName;
			data["jtrak_type"] = _this.type;
			data["jtrak_comeTime"] = initDate;
			data["jtrak_thisUrl"] = B_href;
			data["jtrak_href"] = _this.href;
			data["jtrak_name"] = _this.name;
			//这里获取域名后面， ？前面的内容；
			var B_href_thisUrl;
			var url_start, url_end;
			//获取第三个“/”， 和第一个“？”的位置
			function nthIndexOf(str, c, num) {
				var x = str.indexOf(c);
				for(var i = 0; i < num; i++) {
					x = str.indexOf(c, x + 1);
				}
				return x;
			}
			//当有多个Id，class时，+ # 和 .

			var idArray = _this.id.split(" ");
			//给每一个id前面添加#
			var idStr = '';
			for(var i = 0; i < idArray.length; i++) {
				idStr += "#" + idArray[i];
			}
			data["jtrak_id"] = idStr;
			var classArray = _this.className.split(" ");
			//给每一个id前面添加#
			var classStr = '';
			for(var i = 0; i < classArray.length; i++) {
				classStr += "." + classArray[i];
			}
			data["jtrak_class"] = classStr;
			var classBlank = nthIndexOf(_this.id, " ", 0);
            B_href = window.location.href
			url_start = nthIndexOf(B_href, "/", 2);
			//获取指定字符在字符串中第N次出现的位置
			function find(str,cha,num){
				var x=str.indexOf(cha);
				for(var i=0;i<num;i++){
					x=str.indexOf(cha,x+1);
				}
				return x;
			}
			let domainNum = find(B_href, '/', 2)
			let jtrak_domain = B_href.substring(0, domainNum)
			url_end = nthIndexOf(B_href, "?", 0);
			//取到之后截取字符串；
			//判断有没有？
			if(url_end == -1) {
				B_href_thisUrl = B_href.substring(url_start)
			} else {
				B_href_thisUrl = B_href.substring(url_start, url_end);
			}
			// data["jtrak_thisUrl"] = B_href_thisUrl;
			data["jtrak_domain"] = jtrak_domain;
			data["jtrak_idUrl"] = "";
			data["jtrak_classUrl"] = "";
			if(_this.id != "") {
				data["jtrak_idUrl"] = idStr + B_href_thisUrl;
			}
			if(_this.className != "") {
				data["jtrak_classUrl"] = classStr + B_href_thisUrl;
			}
			event({
				category: pageViewCategory,
				action: action_name,
				data: data
			});

		}
	}

	function trackPageView() {
		if(enableTrackPageView) {
			var data = {};
            data['url'] = decodeURIComponent(encodeWrapper(purify(locationHrefAlias)));
            if(configReferrerUrl.length) {
                data['urlref'] = decodeURIComponent(encodeWrapper(purify(configReferrerUrl)));
            } else {
				data['urlref'] = '';
			}
			if(jtrak_domain) {
				data['jtrak_domain'] = jtrak_domain;
			}
			if(pageTitle){
				data['jtrak_titleName'] = pageTitle;
			}
			//var action_name = encodeWrapper(titleFixup(documentAlias.title));
            if (jingTrack.q[0][0].stopTrackingPageView) {
            } else {
                event({
                    category: pageViewCategory,
                    action: "pageView",
                    data: data
                });
            }
		}
	}
	var init = function(appId, userId, openId) {
		//取cookie的函数


		var isWeChat;
		var uaB = navigator.userAgent.toLowerCase();
		if(uaB.match(/MicroMessenger/i) == "micromessenger") {
			if(uaB.match(/wxwork/i) == "wxwork"){
				isWeChat = 0;
			}else{
				isWeChat = 1;
			}
		} else {
			isWeChat = 0;
		}
		/*如果是微信用户， 并且openid不存在或者前缀是jingwebtrack就要跳转到另一个地址，获取openId，然后再跳回来（oauth跳转）*/

		function GetRequest() {
			var url = location.search; //获取url中"?"符后的字串
			var theRequest = new Object();
			if(url.indexOf("?") != -1) {
				var str = url.substr(1);
				var strs = str.split("&");
				for(var i = 0; i < strs.length; i++) {
					theRequest[strs[i].split("=")[0]] = (strs[i].split("=")[1]);
				}
			}
			return theRequest;
		}
		var Request = new Object();
		Request = GetRequest();
		if(jingTrack.q[0][0].openId !== ""){
			setCookie('jing' + jingTrack.q[0][0].appId + 'openId', jingTrack.q[0][0].openId, 1);
			trak.options.openId = jingTrack.q[0][0].openId;
		}else{
			//先在url上取openid
			var openIdDParam = Request["openid"];
			var hasOpenidParm = false;
			if(openIdDParam !== "" && openIdDParam !== undefined && openIdDParam !== null){
				hasOpenidParm = true;
			}
            let ouathCookie =  getCookie(jingTrack.q[0][0].appId + 'jingOuath')
            let hasOuathCookie = false
            if (ouathCookie !== '' && ouathCookie !== undefined && ouathCookie !== null && ouathCookie !== 0) {
                hasOuathCookie = true
            }
			//如果url上存在openid
			if(hasOpenidParm && hasOuathCookie){
				var openid = openIdDParam;
				//赋值给trak并存到cookie中
				trak.options.openId = openIdDParam;
				setCookie('jing' + jingTrack.q[0][0].appId + 'openId', openIdDParam, 1);
                setCookie(jingTrack.q[0][0].appId + 'jingOuath', 0)
			}else{
				//否则， 在cookie中找openid
				var cookieOpenId = getCookie('jing' + jingTrack.q[0][0].appId + 'openId');
				//如果cookie中有
				if(cookieOpenId !== "" && cookieOpenId !== "undefined" && cookieOpenId !== null){
					var openid = cookieOpenId;
					//复制给trak，并存在cookie中
					trak.options.openId = cookieOpenId;
					setCookie('jing' + jingTrack.q[0][0].appId + 'openId', cookieOpenId, 1);
				}else if(isWeChat == 1 && !jingTrack.q[0][0].stopOauthGetOpenId){
                    setCookie(jingTrack.q[0][0].appId + 'jingOuath', 1)
					backUrl = encodeURIComponent(decodeURIComponent(backUrl))
					//如果cookie中也没有， 并且是微信用户的话， 就取跳转获取openid
					if (jingTrack.q[0][0].componentId !== "") {
                        window.location.href = "https://app.jingsocial.com/api/h5/componentAuthV2?redirectUri="+backUrl+"&appid="+jingTrack.q[0][0].appId+"&component_appid="+jingTrack.q[0][0].componentId+"&scope=base";
                    } else {
                        //如果cookie中也没有， 并且是微信用户的话， 就取跳转获取openid
                        window.location.href = "https://app.jingsocial.com/apiv2/thirdparty/defaultOauth5?appid=" + jingTrack.q[0][0].appId + "&redirectUri=" + backUrl + "&scope=base";
                    }
				}
			}
		}


		if(!appId) {
			console.log("don't have appId!");
			return;
		}
		if(appId) {
			trak.options.appId = appId;
		}
		if(!userId){
			// 这里留着， 暂时什么都不做， 如果没定义userId就不传给后台
		}
		if(userId) {
			trak.options.userId = userId;
		}
		var trakElements = document.querySelectorAll('[data-trak]');

		for(var i = 0; i < trakElements.length; i++) {
			var _options = JSON.parse(trakElements[i].getAttribute('data-trak'));

			// This allows us to choose other event types but sets click as the default
			var trigger = _options.trigger || 'click';

			if(trakElements[i].addEventListener) {
				trakElements[i].addEventListener(trigger, attrEvent);
			} else if(trakElements[i].attachEvent) {
				trakElements[i].attachEvent('on' + trigger, attrEvent);
			}
		}

		var flag = 0;
		for(var key2 in umt) {
			var umt_val2 = getParameterByName(umt[key2]);
			if(umt_val2) {
				flag = 1
			}
		}
		if(flag){
			for(var key in umt) {
				var umt_val = getParameterByName(umt[key]);
				if(umt_val) {
					setCookie(umt[key], umt_val, 1);
				}else{
					if(getCookie(umt[key])){
						delCookie(umt[key]);
					}
				}
			}
		}

		detectBrowserFeatures();
		visitorUuid = loadVisitorIdCookie();
		trackPageView();
		//什么标签需要调用这个跟踪
		Bruce_disp("aInputs");
		Bruce_disp("aAs");
		Bruce_disp("aButtons");
		Bruce_disp("aTextareas");
		Bruce_disp("aSelects");


	};
	return {
		init: init,
		clean: clean,
		event: event,
        custom_event: custom_event,
		enableTrackPageView: enableTrackPage,
		attrEvent: attrEvent,
		wildcard: wildcard,
		options: settings
	};
})();

// Check for AMD/Module support, otherwise define trak as a global variable.
if(typeof define !== 'undefined' && define.amd) {
	// AMD. Register as an anonymous module.
	define(function() {
		'use strict';
		return trak;
	});
} else if(typeof module !== 'undefined' && module.exports) {
	module.exports = trak;
} else {
	window.trak = trak;
}
trak.enableTrackPageView(jingTrack.q[0][0].category);
trak.init(jingTrack.q[0][0].appId, jingTrack.q[0][0].userId);
